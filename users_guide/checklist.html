<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Checklist for Configuring a WESTPA Simulation &mdash; WESTPA 1.0b1 documentation</title>
    
    <link rel="stylesheet" href="../static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0b1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <link rel="top" title="WESTPA 1.0b1 documentation" href="../sphinx_index.html" />
    <link rel="next" title="Command Line Tool Index" href="command_line_tools.html" />
    <link rel="prev" title="WEST Extensions" href="westext.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="checklist-for-configuring-a-westpa-simulation">
<h1>Checklist for Configuring a WESTPA Simulation<a class="headerlink" href="#checklist-for-configuring-a-westpa-simulation" title="Permalink to this headline">¶</a></h1>
<ul>
<li><p class="first">Files for dynamics propagation</p>
<ul class="simple">
<li>Have you set up all of the files for propagating the dynamics (e.g. for
GROMACS, the .top, .gro, .mdp, and .ndx files)?</li>
</ul>
</li>
<li><p class="first">System implementation (<code class="docutils literal"><span class="pre">system.py</span></code>)</p>
<ul class="simple">
<li>Is <code class="docutils literal"><span class="pre">self.pcoord_len</span></code> set to the number of data points that
corresponds to the frequency with which the dynamics engine outputs the
progress coordinate? Note: Many MD engines (e.g. GROMACS) output the
initial point (i.e. zero).</li>
<li>Are the bins in the expected positions? You can easily view the positions
of the bins using a Python interpreter.</li>
</ul>
</li>
<li><p class="first">Initializing the simulation (<code class="docutils literal"><span class="pre">init.sh</span></code>)</p>
<ul class="simple">
<li>Is the directory structure for the trajectory output files
consistent with specifications in the master configuration file
(<code class="docutils literal"><span class="pre">west.cfg</span></code>)?</li>
<li>Are the basis (bstate) states, and if applicable, target states (tstate),
specified correctly?</li>
</ul>
</li>
<li><p class="first">Calculating the progress coordinate for initial states (<code class="docutils literal"><span class="pre">get_pcoord.sh</span></code>)</p>
<ul class="simple">
<li>Ensure that the procedure to extract the progress coordinate works by
manually checking the procedure on one (or more) basis state files.</li>
<li>If your initialization (<code class="docutils literal"><span class="pre">init.sh</span></code>) gives an error message indicating the
&#8220;incorrect shape&#8221; of the progress coordinate, check that get_pcoord.sh is
not writing to a single file. If this is the case, w_init will crash since
multiple threads will be simultaneously writing to a single file. To fix
this issue, you can add $$ to the file name (e.g. change <code class="docutils literal"><span class="pre">OUT=dist.xvg</span></code>
to <code class="docutils literal"><span class="pre">OUT=dist_$$.xvg</span></code>) in <code class="docutils literal"><span class="pre">get_pcoord.sh</span></code>.</li>
</ul>
</li>
<li><p class="first">Segment implementation (<code class="docutils literal"><span class="pre">runseg.sh</span></code>)</p>
<ul class="simple">
<li>Ensure that the progress coordinate is being calculated correctly.
If necessary, manually run a single dynamics segment (τ) for a single
trajectory walker to do so (e.g. for GROMACS, run the .tpr file for a
length of τ). Double check that if any analysis programs are being run
that their input is correct.</li>
<li>Are you feeding the velocities and state information required for the
thermostat and barostat from one dynamics segment to the next? In GROMACS,
this information is stored in the .edr and .trr files.</li>
</ul>
</li>
<li><p class="first">Log of simulation progress (<code class="docutils literal"><span class="pre">west.h5</span></code>)</p>
<ul>
<li><p class="first">Check that the first iteration has been initialized, i.e. typing:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>h5ls west.h5/iterations
</pre></div>
</div>
<p>at the command line gives:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>iter_00000001            Group
</pre></div>
</div>
</li>
<li><p class="first">In addition, the progress coordinate should be initialized as well, i.e.
using the command:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>h5ls -d west.h5/iterations/iter_00000001/pcoord
</pre></div>
</div>
<p>shows that the array is populated by zeros and the first point is the value
calculated by get_pcoord.sh:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>pcoord                   Dataset {10, 21, 1}
   Data:
       (0,0,0) 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       (2,15,0) 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0,
       (5,8,0) 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0,
       (8,2,0) 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
<div class="section" id="running-a-westpa-simulation">
<h2>Running a WESTPA simulation<a class="headerlink" href="#running-a-westpa-simulation" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>If you encounter an issue while running the simulation<ul>
<li>Use the <code class="docutils literal"><span class="pre">--debug</span></code> option on the servers w_run and save the output to a file.
(note that this will generate a very detailed log of the process, try
searching for &#8220;ERROR&#8221; for any errors and &#8220;iteration&#8221; to look at every
iteration)</li>
<li>Use a program like hdfview, h5ls or Python with h5py library to open the
<code class="docutils literal"><span class="pre">west.h5</span></code> file and ensure that the progress coordinate is being passed
around correctly.</li>
<li>Use hdfview, h5ls or Python with h5py library to ensure that the number of
trajectory walkers is correct.</li>
</ul>
</li>
<li>Is your simulation failing while the progress coordinate is being calculated?<ul>
<li>One of the most error prone part during an iteration is the progress
coordinate extraction. Programs that are not designed for quick execution
have a lot of trouble during this step (VMD is a very commonly encountered
one for example). Probably the best way to deal with this issue is to hard
code a script to do the progress coordinate extraction. If you are doing
molecular dynamics simulations multiple libraries for Python and C/C++ that
deal with most output formats for MD packages exist and they usually come
with a lot of convenience functions that can help you extract the progress
coordinate. AMBER tools and GROMACS tools seems to work adequately for this
purpose as well.</li>
</ul>
</li>
<li>Is your progress coordinate what you think it is?<ul>
<li>Once your simulation it is running, it is well worth your time to ensure
that the progress coordinate being reported is what you think it is. This
can be done in a number of ways:</li>
<li>Check the <code class="docutils literal"><span class="pre">seg_log</span></code> output. This captures the standard error/output from
the terminal session that your segment ran in, assuming you are running the
executable propagator, and can be useful to ensure that everything is being
done as you believe it should be (GROMACS tools, such as <code class="docutils literal"><span class="pre">g_dist</span></code>, for
instance, report what groups have their distance being calculated here).</li>
<li>Look at a structure! Do so in a program such as VMD or pyMOL, and calculate
your progress coordinate manually and check it visually, if feasible. Does
it look correct, and seem to match what&#8217;s being reported in the .h5 file?
This is well worth your time before the simulation has proceeded very far,
and can save a significant amount of wallclock and computational time.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="analyzing-a-westpa-simulation">
<h2>Analyzing a WESTPA simulation<a class="headerlink" href="#analyzing-a-westpa-simulation" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>If you are running the analysis on shared computing resources<ul>
<li>Be sure to use the <code class="docutils literal"><span class="pre">--serial</span></code> flag (see the individual tool
documentation). Otherwise, many of the included tools default to parallel
mode (w_assign, for instance), which will create as many Python threads as
there are CPU cores available.</li>
</ul>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../sphinx_index.html">
              <img class="logo" src="../static/WESTPA2.jpg" alt="Logo"/>
            </a></p>
  <h3><a href="../sphinx_index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Checklist for Configuring a WESTPA Simulation</a><ul>
<li><a class="reference internal" href="#running-a-westpa-simulation">Running a WESTPA simulation</a></li>
<li><a class="reference internal" href="#analyzing-a-westpa-simulation">Analyzing a WESTPA simulation</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../sphinx_index.html">Documentation overview</a><ul>
      <li>Previous: <a href="westext.html" title="previous chapter">WEST Extensions</a></li>
      <li>Next: <a href="command_line_tools.html" title="next chapter">Command Line Tool Index</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../sources/users_guide/checklist.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Matthew C. Zwier and Lillian T. Chong.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="../sources/users_guide/checklist.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>