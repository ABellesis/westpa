<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>AMBER Tutorial: Molecular Dynamics of Na+/Cl- Association &#8212; WESTPA 1.0b1 documentation</title>
    
    <link rel="stylesheet" href="../static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0b1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="WESTPA 1.0b1 documentation" href="../sphinx_index.html" />
    <link rel="next" title="GROMACS Tutorial: Molecular Dynamics of Na+/Cl- Association" href="gromacs.html" />
    <link rel="prev" title="NAMD example: Molecular dynamics simulation of Chignolin" href="chignolin.html" />
   
  <link rel="stylesheet" href="../static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="amber-tutorial-molecular-dynamics-of-na-cl-association">
<span id="amber-tutorial"></span><h1>AMBER Tutorial: Molecular Dynamics of Na<sup>+</sup>/Cl<sup>-</sup> Association<a class="headerlink" href="#amber-tutorial-molecular-dynamics-of-na-cl-association" title="Permalink to this headline">¶</a></h1>
<p>by Karl Debiec and Daniel Hatfield</p>
<p>Updated with WESTPA version 1.0 beta and Amber 14</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Requirements: ~1 hr wallclock time on an 8-core Intel Westmere node (one walker
per core); ~1.2 GB disk space</p>
<p>In this introductory tutorial we will use the weighted ensemble strategy to
simulate Na<sup>+</sup>/Cl<sup>-</sup> association in Generalized Born implicit
solvent. The system consists of single Na<sup>+</sup> and Cl<sup>-</sup> ions
modeled with the
<a class="reference external" href="http://ambermd.org/#ff">Amber force field</a>,
using the distance between the two ions as the progress coordinate.
<a class="reference external" href="http://ambermd.org">Amber</a> will be used to run the
molecular dynamics, and familiarity with it is a prerequisite (see <a class="reference external" href="http://ambermd.org/tutorials">tutorials</a>).
Basic knowledge of python and bash scripting is also necessary.</p>
<p>The first step is to set up a directory containing the necessary Amber and
WESTPA files. A working example directory can be found at
<code class="docutils literal"><span class="pre">westpa/lib/examples/nacl_amb</span></code>.</p>
</div>
<div class="section" id="preparing-the-amber-files">
<h2>Preparing the Amber files<a class="headerlink" href="#preparing-the-amber-files" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Input File</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>nacl.prm</td>
<td>topology</td>
</tr>
<tr class="row-odd"><td>nacl.crd</td>
<td>coordinates</td>
</tr>
<tr class="row-even"><td>md-genvel.in</td>
<td>configuration for initial segments</td>
</tr>
<tr class="row-odd"><td>md-continue.in</td>
<td>configuration for continuations</td>
</tr>
</tbody>
</table>
<p>The above files are included in the <code class="docutils literal"><span class="pre">amber_config</span></code> subfolder of the example
directory, and should be familiar to Amber users. Note that two configuration
files are present.
<code class="docutils literal"><span class="pre">md-genvel.in</span></code> is used for initial segments, in which it is necessary to
generate initial velocities, and <code class="docutils literal"><span class="pre">md-continue.in</span></code> is used for
continuations, in which velocities are inherited from the parent segment.</p>
<div class="section" id="md-continue-in">
<h3>md-continue.in<a class="headerlink" href="#md-continue-in" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">0.5</span> <span class="n">ps</span> <span class="n">NVT</span> <span class="n">production</span> <span class="k">with</span> <span class="n">Langevin</span> <span class="n">thermostat</span> <span class="ow">and</span> <span class="n">GB</span> <span class="n">implicit</span> <span class="n">solvent</span>
<span class="c1">################################### CONTROL ###################################</span>
<span class="o">&amp;</span><span class="n">cntrl</span>
<span class="c1">#################################### INPUT ####################################</span>
  <span class="n">ntx</span>       <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>        <span class="c1"># Read input coordinates and velocities</span>
  <span class="n">irest</span>     <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>        <span class="c1"># Restart calculation from input file</span>
  <span class="n">ig</span>        <span class="o">=</span> <span class="n">RAND</span><span class="p">,</span>     <span class="c1"># Use random seed from WESTPA</span>
<span class="c1">################################# INTEGRATOR ##################################</span>
  <span class="n">dt</span>        <span class="o">=</span> <span class="mf">0.002</span><span class="p">,</span>    <span class="c1"># Timestep (ps)</span>
  <span class="n">nstlim</span>    <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>      <span class="c1"># Simulation duration (timesteps)</span>
<span class="c1">################################## ENSEMBLE ###################################</span>
  <span class="n">ntt</span>       <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>        <span class="c1"># Langevin thermostat</span>
  <span class="n">temp0</span>     <span class="o">=</span> <span class="mf">300.0</span><span class="p">,</span>    <span class="c1"># System temperature (K)</span>
  <span class="n">gamma_ln</span>  <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>      <span class="c1"># Langevin collision frequency (1 / tau)</span>
  <span class="p">(</span><span class="n">ps</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">########################### NONBONDED INTERACTIONS ############################</span>
  <span class="n">cut</span>       <span class="o">=</span> <span class="mf">999.0</span><span class="p">,</span>    <span class="c1"># Nonbonded cutoff (A)</span>
  <span class="n">rgbmax</span>    <span class="o">=</span> <span class="mf">999.0</span><span class="p">,</span>    <span class="c1"># Cutoff for effective Born radii</span>
  <span class="n">calculation</span> <span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="c1">############################## IMPLICIT SOLVENT ###############################</span>
  <span class="n">igb</span>       <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>        <span class="c1"># Generalized Born implicit solvent</span>
<span class="c1">################################### OUTPUT ####################################</span>
  <span class="n">ntpr</span>      <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>       <span class="c1"># Log output interval (timesteps)</span>
  <span class="n">ntxo</span>      <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>        <span class="c1"># Output restart file in NetCDF binary format</span>
  <span class="n">ntwr</span>      <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>      <span class="c1"># Restart file output interval (timesteps)</span>
  <span class="n">ioutfm</span>    <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>        <span class="c1"># Output trajectory in NetCDF binary format</span>
  <span class="n">ntwx</span>      <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>       <span class="c1"># Trajectory output interval (timesteps)</span>
  <span class="o">&amp;</span><span class="n">end</span>
</pre></div>
</div>
<p>Note that the comments in this input file must be removed prior to use with
Amber, uncommented versions are provided in the example directory.</p>
<p>Several settings in this configuration file are important to WESTPA. First is
the the segment duration, τ, which is equal to the timestep times the number of
steps. The appropriate τ depends on the system and progress coordinate, and for
this system we have chosen 0.5 ps. Second is the use of the stochastic Langevin
thermostat; WESTPA requires a stochastic element such that trajectories
branched from a common point diverge. In order to ensure that this occurs, it
is also necessary to set the random seed to a different value for each segment.
Setting the random seed based on the time, as is common for brute-force
simulations, may cause problems as simulations started simultaneously from the
same parent will not diverge.</p>
<p>The analogous <code class="docutils literal"><span class="pre">md-genvel.in</span></code> differs only in that it does not load
velocities from the input file, instead generating them from a Maxwellian
distribution.</p>
</div>
</div>
<div class="section" id="preparing-the-westpa-files">
<h2>Preparing the WESTPA files<a class="headerlink" href="#preparing-the-westpa-files" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Input File</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>env.sh</td>
<td>set environment variables</td>
</tr>
<tr class="row-odd"><td>gen_istate.sh</td>
<td>generate initial states from basis states</td>
</tr>
<tr class="row-even"><td>get_pcoord.sh</td>
<td>calculate progress coordinate for initial states</td>
</tr>
<tr class="row-odd"><td>west.cfg</td>
<td>WESTPA configuration</td>
</tr>
<tr class="row-even"><td>aux_functions.py</td>
<td>functions for loading auxilliary data</td>
</tr>
<tr class="row-odd"><td>runseg.sh</td>
<td>segment implementation</td>
</tr>
<tr class="row-even"><td>post_iter.sh</td>
<td>post-segment cleanup</td>
</tr>
<tr class="row-odd"><td>init.sh</td>
<td>initialize WESTPA</td>
</tr>
<tr class="row-even"><td>run.sh</td>
<td>run WESTPA</td>
</tr>
<tr class="row-odd"><td>tar_segs.sh</td>
<td>tar segments</td>
</tr>
</tbody>
</table>
<p>The above files are listed roughly in the order in which it is appropriate to
configure them. <code class="docutils literal"><span class="pre">gen_istate.sh</span></code>, <code class="docutils literal"><span class="pre">get_pcoord.sh</span></code>, <code class="docutils literal"><span class="pre">runseg.sh</span></code>, and
<code class="docutils literal"><span class="pre">post_iter.sh</span></code> are located in the <code class="docutils literal"><span class="pre">westpa_scripts</span></code> subfolder.</p>
<p>Typically when setting up a WESTPA simulation, you will need to write these
files yourself or modify the files provided in an example, such as this
tutorial.</p>
<div class="section" id="env-sh">
<h3>env.sh<a class="headerlink" href="#env-sh" title="Permalink to this headline">¶</a></h3>
<p>This script sets environment variables that may be used across the simulation.
These include the root directory for WESTPA, the root directory for the
simulation, the name for the simulation, and the python executable to use. It
also sets the executables for Amber; using an environment variable for this
purpose makes it easier to transition code to different hardware or test
different builds or flags of an MD code without editing multiple files.</p>
<p>Make sure that your <code class="docutils literal"><span class="pre">$AMBERHOME</span></code> environment variable is correctly set and
that <code class="docutils literal"><span class="pre">$AMBERHOME/lib</span></code> is in <code class="docutils literal"><span class="pre">$LD_LIBRARY_PATH</span></code>. This should be the case if
you have sourced <code class="docutils literal"><span class="pre">amber.sh</span></code> from your Amber installation directory.</p>
</div>
<div class="section" id="gen-istates-sh">
<h3>gen_istates.sh<a class="headerlink" href="#gen-istates-sh" title="Permalink to this headline">¶</a></h3>
<p>This script generates initial states (configurations) for the simulation from
the basis state stored in the <code class="docutils literal"><span class="pre">bstates</span></code> subfolder. Our system uses a single
basis state containing the two ions with a separation of 9.90 Å; this script
generates slight variations of this distance in order to obtain a greater
variety of starting configurations.</p>
</div>
<div class="section" id="get-pcoord-sh">
<h3>get_pcoord.sh<a class="headerlink" href="#get-pcoord-sh" title="Permalink to this headline">¶</a></h3>
<p>This script calculates the progress coordinate for each of the initial states.
Our progress coordinate is the distance between the Na<sup>+</sup> and Cl<sup>-</sup> ions, which we calculate using AmberTools&#8217; <code class="docutils literal"><span class="pre">cpptraj</span></code>. Note that this
script is used only during initial state generation; throughout the remainder of
the weighted ensemble simulation, <code class="docutils literal"><span class="pre">runseg.sh</span></code> calculates the progress
coordinate.</p>
</div>
<div class="section" id="west-cfg">
<h3>west.cfg<a class="headerlink" href="#west-cfg" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>This file defines the WESTPA configuration, including:</dt>
<dd><ul class="first last simple">
<li>the number of dimensions of the progress coordinate</li>
<li>the number of data points per trajectory segment</li>
<li>the binning scheme and number of walkers per bin</li>
<li>the number of weighted ensemble iterations to run</li>
<li>the locations of various scripts</li>
</ul>
</dd>
</dl>
<p>For this system we use 22 bins as defined by <a class="reference external" href="http://pubs.acs.org/doi/abs/10.1021/ct100626x">Zwier, Kaus, and Chong</a>, and 24 walkers per bin.</p>
</div>
<div class="section" id="aux-functions-py">
<h3>aux_functions.py<a class="headerlink" href="#aux-functions-py" title="Permalink to this headline">¶</a></h3>
<p>In addition to the progress coordinate, WESTPA includes the ability to
calculate and store auxiliary data as the simulation is run. This is often
easier than looping over iterations and segments afterwards. Since our system
contains only two atoms, it is reasonable for us to store all coordinate
information in the same hdf5 file as the progress coordinate. We will also
store the log information including time, energy, and temperature.</p>
<p>This file contains Python functions for loading the coordinates and other
auxilliary information. The location (module and function name) of these
functions is specified to WESTPA in <code class="docutils literal"><span class="pre">west.cfg</span></code>.</p>
</div>
<div class="section" id="runseg-sh">
<h3>runseg.sh<a class="headerlink" href="#runseg-sh" title="Permalink to this headline">¶</a></h3>
<p>This script runs individual segments, calculates and outputs their progress
coordinates, and outputs auxiliary data. For each iteration and segment it
generates a folder, linking to the files necessary for running Amber.
For the Amber configuration file, it uses <code class="docutils literal"><span class="pre">sed</span></code> to input a random seed
generated by WESTPA. It then runs Amber, calculates and outputs the progress
coordinate and auxiliary data, and removes files that are no longer needed. As
in <code class="docutils literal"><span class="pre">get_pcoord.sh</span></code>, the progress coordinate is calculated using AmberTools&#8217;
<code class="docutils literal"><span class="pre">cpptraj</span></code>.
The auxiliary coordinate dataset is also prepared using <code class="docutils literal"><span class="pre">cpptraj</span></code>, which is
used to convert to trajectory to pdb format, which is processed using shell
commands and output to a temporary file, from which it is read by the
<code class="docutils literal"><span class="pre">coord_loader</span></code> function in <code class="docutils literal"><span class="pre">aux_functions.py</span></code>.
The auxiliary log data is similarly processed using shell commands and output
to a temporary file, from which it is further processed and stored by the
<code class="docutils literal"><span class="pre">log_loader</span></code> function in <code class="docutils literal"><span class="pre">aux_functions.py</span></code>.</p>
</div>
<div class="section" id="post-iter-sh">
<h3>post_iter.sh<a class="headerlink" href="#post-iter-sh" title="Permalink to this headline">¶</a></h3>
<p>This script cleans up after each iteration. WESTPA simulations can generate
large numbers of files, potentially conflicting with filesystem restrictions.
After each iteration, <code class="docutils literal"><span class="pre">post_iter.sh</span></code> packages the segment logs as a <code class="docutils literal"><span class="pre">tar</span></code>
file.</p>
</div>
<div class="section" id="init-sh">
<h3>init.sh<a class="headerlink" href="#init-sh" title="Permalink to this headline">¶</a></h3>
<p>This script initializes the WESTPA system. It removes files from previous runs
and uses <code class="docutils literal"><span class="pre">gen_istates.sh</span></code> and <code class="docutils literal"><span class="pre">get_pcoord.sh</span></code> to generate initial states. This
is also where the basis states and target states are defined. For this system
we define the bound target state as 1.8 Å separation, and the unbound target
state as 16.9 Å separation. Once walkers reach the bins containing these values
(i.e. our first and final bins), they are recycled. <code class="docutils literal"><span class="pre">init.sh</span></code> is also one of
two places where we specify the number of walkers per bin, as
<code class="docutils literal"><span class="pre">--segs-per-state</span></code>.</p>
</div>
<div class="section" id="run-sh">
<h3>run.sh<a class="headerlink" href="#run-sh" title="Permalink to this headline">¶</a></h3>
<p>This script is used to run WESTPA.</p>
</div>
<div class="section" id="tar-segs-sh">
<h3>tar_segs.sh<a class="headerlink" href="#tar-segs-sh" title="Permalink to this headline">¶</a></h3>
<p>This script is used to tar segments after the WESTPA simulation has been run,
in order to reduce the number of files produced. In order to allow extension of
the simulation, the last segment is not tarred. Typically, it is advisable not
to tar segments after each iteration (i.e. in <code class="docutils literal"><span class="pre">post_iter.sh</span></code>), while the main
WESTPA process is tarring, other cores are idle, potentially wasting CPU time.</p>
</div>
</div>
<div class="section" id="running-the-simulation">
<h2>Running the simulation<a class="headerlink" href="#running-the-simulation" title="Permalink to this headline">¶</a></h2>
<p>Make sure that the environment variable <code class="docutils literal"><span class="pre">$WEST_ROOT</span></code> is set and points your
WESTPA installation.  To set this variable, enter
<code class="docutils literal"><span class="pre">export</span> <span class="pre">WEST_ROOT=/path/to/your/westpa/installation</span></code> at the terminal,
modifying the command with the appropriate path.  You can check if
<code class="docutils literal"><span class="pre">$WEST_ROOT</span></code> is set by typing <code class="docutils literal"><span class="pre">echo</span> <span class="pre">$WEST_ROOT</span></code> at the terminal.</p>
<p>From the simulation root directory (<code class="docutils literal"><span class="pre">$WEST_SIM_ROOT</span></code>), the simulation may be
initialized using the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">init</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>and run using the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">init.sh</span></code> and <code class="docutils literal"><span class="pre">run.sh</span></code> call <code class="docutils literal"><span class="pre">w_init</span></code> and <code class="docutils literal"><span class="pre">w_run</span></code> from WESTPA. By
default WESTPA will use as many cores as are available on the host machine. If
the simulation is run on a computing cluster, <code class="docutils literal"><span class="pre">w_run</span></code> may be executed from
a batch script. See the <a class="reference internal" href="../users_guide/west/running.html#running"><span class="std std-ref">Running</span></a> page for more information on how to
submit jobs to specific clusters.</p>
</div>
<div class="section" id="analyzing-the-data">
<h2>Analyzing the data<a class="headerlink" href="#analyzing-the-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="output">
<h3>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Output File</th>
<th class="head">Remarks</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>traj_segs</td>
<td>output from each iteration and segment</td>
</tr>
<tr class="row-odd"><td>seg_logs</td>
<td>log files from each iteration and segment</td>
</tr>
<tr class="row-even"><td>west.h5</td>
<td>WESTPA output in hdf5 database</td>
</tr>
<tr class="row-odd"><td>west.log</td>
<td>WESTPA log file</td>
</tr>
</tbody>
</table>
<div class="section" id="traj-segs">
<h4>traj_segs<a class="headerlink" href="#traj-segs" title="Permalink to this headline">¶</a></h4>
<p>This folder stores the results of the WESTPA simulation, organized by iteration
and segment. This includes all files generated by <code class="docutils literal"><span class="pre">runseg.sh</span></code>, including
those generated by Amber.
For this system, the only files saved are <code class="docutils literal"><span class="pre">seg.crd</span></code>, <code class="docutils literal"><span class="pre">seg.rst</span></code>, and
<code class="docutils literal"><span class="pre">seg.log</span></code> corresponding to the coordinates, final restart, and log.
After the simulation has been run, <code class="docutils literal"><span class="pre">tar_segs.sh</span></code> may be used to reduce each
iteration to a single tar file.</p>
</div>
<div class="section" id="seg-logs">
<h4>seg_logs<a class="headerlink" href="#seg-logs" title="Permalink to this headline">¶</a></h4>
<p>This folder stores logs from each iteration and segment. After each weighted
ensemble iteration, <code class="docutils literal"><span class="pre">post_iter.sh</span></code> combines the log files from all of that
iteration&#8217;s segments into a single tar file.</p>
</div>
<div class="section" id="west-h5">
<h4>west.h5<a class="headerlink" href="#west-h5" title="Permalink to this headline">¶</a></h4>
<p>This file stores the simulation output in an hdf5 database. This includes the
relationships between successive walkers, bin weights, progress coordinates,
and auxiliary data.</p>
</div>
<div class="section" id="west-log">
<h4>west.log<a class="headerlink" href="#west-log" title="Permalink to this headline">¶</a></h4>
<p>This file contains a brief log of simulation progress. As WESTPA runs, it
outputs information such as the current iteration number, the number of
populated bins, and the time needed for each iteration in this log. This is
also where errors are output.</p>
<p>Since only 10 iterations have been run, we do not yet have enough data to
analyze. Edit <code class="docutils literal"><span class="pre">west.cfg</span></code> and change <code class="docutils literal"><span class="pre">max_total_iterations</span></code> to 100. Extend
using the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>The simulation will automatically continue from where it left off.</p>
</div>
</div>
<div class="section" id="computing-the-association-rate">
<h3>Computing the association rate<a class="headerlink" href="#computing-the-association-rate" title="Permalink to this headline">¶</a></h3>
<p>WESTPA includes several tools for analysis located in <code class="docutils literal"><span class="pre">$WEST_ROOT/bin</span></code>. In
<code class="docutils literal"><span class="pre">init.sh</span></code> we specified the bin containing an Na<sup>+</sup>/Cl<sup>-</sup>
distance of 1.8 Å as the bound state, and that containing a distance of 16.9 Å
as the unbound state. Using <code class="docutils literal"><span class="pre">w_fluxanl</span></code>, we can calculate the flux into these
target states, and from that calculate the association rate of Na<sup>+</sup>/Cl<sup>-</sup>. <code class="docutils literal"><span class="pre">w_fluxanl</span></code> may be run with the following commands:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>source env.sh
$WEST_ROOT/bin/w_fluxanl
</pre></div>
</div>
<p>The script will output the flux into the target states including confidence
intervals calculated using the block bootstrap method:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Calculating</span> <span class="n">mean</span> <span class="n">flux</span> <span class="ow">and</span> <span class="n">confidence</span> <span class="n">intervals</span> <span class="k">for</span> <span class="n">iterations</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">)</span>
<span class="n">target</span> <span class="s1">&#39;unbound&#39;</span><span class="p">:</span>
  <span class="n">correlation</span> <span class="n">length</span> <span class="o">=</span> <span class="n">a</span> <span class="n">tau</span>
  <span class="n">mean</span> <span class="n">flux</span> <span class="ow">and</span> <span class="n">CI</span>   <span class="o">=</span> <span class="n">b</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="n">tau</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">target</span> <span class="s1">&#39;bound&#39;</span><span class="p">:</span>
  <span class="n">correlation</span> <span class="n">length</span> <span class="o">=</span> <span class="n">w</span> <span class="n">tau</span>
  <span class="n">mean</span> <span class="n">flux</span> <span class="ow">and</span> <span class="n">CI</span>   <span class="o">=</span> <span class="n">x</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="n">tau</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>More information on how to use <code class="docutils literal"><span class="pre">w_fluxanl</span></code> can be viewed using the <code class="docutils literal"><span class="pre">--help</span></code>
flag. <code class="docutils literal"><span class="pre">w_fluxanl</span></code> also stores this information in an hdf5 file,
<code class="docutils literal"><span class="pre">fluxanl.h5</span></code>. Using the python libraries <code class="docutils literal"><span class="pre">h5py</span></code> and <code class="docutils literal"><span class="pre">pylab</span></code>, we can
visualize this data. Open a python interpreter and run the following commands:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">h5py</span><span class="o">,</span> <span class="nn">numpy</span><span class="o">,</span> <span class="nn">pylab</span>
<span class="n">fluxanl</span>              <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;fluxanl.h5&#39;</span><span class="p">)</span>
<span class="n">flux</span>                 <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">first_binding</span>        <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">fluxanl</span><span class="p">[</span><span class="s1">&#39;target_flux&#39;</span><span class="p">][</span><span class="s1">&#39;target_1&#39;</span><span class="p">][</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">flux</span><span class="p">[</span><span class="n">first_binding</span><span class="p">:]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fluxanl</span><span class="p">[</span><span class="s1">&#39;target_flux&#39;</span><span class="p">][</span><span class="s1">&#39;target_1&#39;</span><span class="p">][</span><span class="s1">&#39;flux&#39;</span><span class="p">])</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">flux</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Iteration&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Instantaneous Flux $(</span><span class="se">\\</span><span class="s2">frac</span><span class="si">{1}</span><span class="s2">{</span><span class="se">\\</span><span class="s2">tau})$&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure">
<img alt="../images/nacl_amber_flux_instantaneous.png" src="../images/nacl_amber_flux_instantaneous.png" />
</div>
<p>The x-axis represents the iteration number, and the y-axis the flux into the
bound state in units of τ<sup>-1</sup> during that iteration. In the above
simulation, the first transition to the unbound state occurred in iteration 2,
and the first transition to the bound state occurred in iteration 3. The
instantaneous flux is noisy and difficult to interpret, and it is clearer to
view the time evolution of the flux. Run <code class="docutils literal"><span class="pre">w_fluxanl</span></code> again, this time with
the <code class="docutils literal"><span class="pre">--evol</span></code> flag:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$WEST_ROOT/bin/w_fluxanl --evol
</pre></div>
</div>
<p>We may plot the time evolution of flux using the following commands at a python
interpreter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">h5py</span><span class="o">,</span> <span class="nn">numpy</span><span class="o">,</span> <span class="nn">pylab</span>
<span class="n">fluxanl</span>   <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;fluxanl.h5&#39;</span><span class="p">)</span>
<span class="n">mean_flux</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ci_ub</span>     <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ci_lb</span>     <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">first_binding</span>             <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">fluxanl</span><span class="p">[</span><span class="s1">&#39;target_flux&#39;</span><span class="p">][</span><span class="s1">&#39;target_1&#39;</span><span class="p">][</span><span class="s1">&#39;flux_evolution&#39;</span><span class="p">][</span><span class="s1">&#39;expected&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mean_flux</span><span class="p">[</span><span class="n">first_binding</span><span class="p">:]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fluxanl</span><span class="p">[</span><span class="s1">&#39;target_flux&#39;</span><span class="p">][</span><span class="s1">&#39;target_1&#39;</span><span class="p">][</span><span class="s1">&#39;flux_evolution&#39;</span><span class="p">][</span><span class="s1">&#39;expected&#39;</span><span class="p">])</span>
<span class="n">ci_lb</span><span class="p">[</span><span class="n">first_binding</span><span class="p">:]</span>     <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fluxanl</span><span class="p">[</span><span class="s1">&#39;target_flux&#39;</span><span class="p">][</span><span class="s1">&#39;target_1&#39;</span><span class="p">][</span><span class="s1">&#39;flux_evolution&#39;</span><span class="p">][</span><span class="s1">&#39;ci_lbound&#39;</span><span class="p">])</span>
<span class="n">ci_ub</span><span class="p">[</span><span class="n">first_binding</span><span class="p">:]</span>     <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fluxanl</span><span class="p">[</span><span class="s1">&#39;target_flux&#39;</span><span class="p">][</span><span class="s1">&#39;target_1&#39;</span><span class="p">][</span><span class="s1">&#39;flux_evolution&#39;</span><span class="p">][</span><span class="s1">&#39;ci_ubound&#39;</span><span class="p">])</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mean_flux</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ci_lb</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ci_ub</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Iteration&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean Flux $(</span><span class="se">\\</span><span class="s2">frac</span><span class="si">{1}</span><span class="s2">{</span><span class="se">\\</span><span class="s2">tau})$&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure">
<img alt="../images/nacl_amber_flux_evolution.png" src="../images/nacl_amber_flux_evolution.png" />
</div>
<p>We can see that the flux has plateaued, indicating that the simulation has
reached steady-state conditions. When calculating the rate, we discard the
portion of data during which the system is equilibrating, using only portion
over which the rates are steady and converging. We may calculate the rate using
only the last 50 iterations:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$WEST_ROOT/bin/w_fluxanl --first-iter 50

Calculating mean flux and confidence intervals for iterations [50,101)
target &#39;unbound&#39;:
  correlation length = 0 tau
  mean flux and CI   = 1.149779e-01 (1.094747e-01,1.209451e-01) tau^(-1)
target &#39;bound&#39;:
  correlation length = 0 tau
  mean flux and CI   = 3.054023e-03 (2.378604e-03,3.863012e-03) tau^(-1)
</pre></div>
</div>
<p>Your output should be within an order of magnitude. Since τ for our simulation
was 0.5 ps, in order to determine the association rate in units of ps<sup>-1</sup>, the flux should be multiplied by 2, giving an association rate of
6.1 x 10<sup>-3</sup> ps<sup>-1</sup> with a 95% CI of 4.7 x10<sup>-3</sup> to 7.7
x10<sup>-3</sup>. In order to obtain a more precise association rate, we would
need to run more iterations of the simulation, which may be done by editing
<code class="docutils literal"><span class="pre">west.cfg</span></code>.</p>
</div>
<div class="section" id="visualizing-a-selected-pathway">
<h3>Visualizing a selected pathway<a class="headerlink" href="#visualizing-a-selected-pathway" title="Permalink to this headline">¶</a></h3>
<p>Westpa includes the tools <code class="docutils literal"><span class="pre">w_succ</span></code> and <code class="docutils literal"><span class="pre">w_trace</span></code> to make concatenating
the segments for one of your completed pathways straightforward. Both
<code class="docutils literal"><span class="pre">w_succ</span></code> and <code class="docutils literal"><span class="pre">w_trace</span></code> are located in <code class="docutils literal"><span class="pre">$WEST_ROOT/bin</span></code>.</p>
<p>First use <code class="docutils literal"><span class="pre">w_succ</span></code> by entering into the command line from your simulation
root directory:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>source env.sh
$WEST_ROOT/bin/w_succ
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">w_succ</span></code> will output a list of every completed pathway, listed by its
iteration and segment ids. The target state each pathway has reached may be
determined from the final value of the progress coordinate. Pick any set of
completed iteration and segment ids and use them with the <code class="docutils literal"><span class="pre">w_trace</span></code> tool.
For example, if iteration 17 segment 2 is a completed pathway, run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$WEST_ROOT/bin/w_trace 17:2
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">w_trace</span></code> will output a text file named <code class="docutils literal"><span class="pre">traj_17_2_trace.txt</span></code> listing the
iteration and segment ids for the chain of continuing segments leading up to
the successful completion of your simulation. This file includes the iteration,
seg_id, weight, wallclock time, CPU time, and final progress coordinate value
for each segment comprising the trajectory. The first line, listed as iteration
0, includes the initial state ID. The same information is stored in hdf5 format
in the outfile <code class="docutils literal"><span class="pre">trajs.h5</span></code>.</p>
<p>By combining the information in this file with the coordinates stored in
<code class="docutils literal"><span class="pre">west.h5</span></code>, we can generate a complete trajectory viewable using <a class="reference external" href="http://www.ks.uiuc.edu/Research/vmd">Visual
Molecular Dynamics</a> using the script
<code class="docutils literal"><span class="pre">cat_trajectory.py</span></code>, included in the <code class="docutils literal"><span class="pre">westpa_scripts</span></code> subfolder:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">h5py</span><span class="o">,</span> <span class="nn">numpy</span><span class="o">,</span> <span class="nn">sys</span>

<span class="n">infile</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">usecols</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">west</span>   <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;west.h5&#39;</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">iteration</span><span class="p">,</span> <span class="n">seg_id</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">iter_key</span> <span class="o">=</span> <span class="s2">&quot;iter_</span><span class="si">{0:08d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">iteration</span><span class="p">))</span>
    <span class="n">SOD</span>      <span class="o">=</span> <span class="n">west</span><span class="p">[</span><span class="s1">&#39;iterations&#39;</span><span class="p">][</span><span class="n">iter_key</span><span class="p">][</span><span class="s1">&#39;auxdata&#39;</span><span class="p">][</span><span class="s1">&#39;coord&#39;</span><span class="p">][</span><span class="n">seg_id</span><span class="p">,</span><span class="mi">1</span><span class="p">:,</span><span class="mi">0</span><span class="p">,:]</span>
    <span class="n">CLA</span>      <span class="o">=</span> <span class="n">west</span><span class="p">[</span><span class="s1">&#39;iterations&#39;</span><span class="p">][</span><span class="n">iter_key</span><span class="p">][</span><span class="s1">&#39;auxdata&#39;</span><span class="p">][</span><span class="s1">&#39;coord&#39;</span><span class="p">][</span><span class="n">seg_id</span><span class="p">,</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">,:]</span>
    <span class="n">coords</span>  <span class="o">+=</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">SOD</span><span class="p">,</span> <span class="n">CLA</span><span class="p">))]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.xyz&quot;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">coords</span><span class="p">)):</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;SOD </span><span class="si">{0:9.5f}</span><span class="s2"> </span><span class="si">{1:9.5f}</span><span class="s2"> </span><span class="si">{2:9.5f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
          <span class="nb">float</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;CLA </span><span class="si">{0:9.5f}</span><span class="s2"> </span><span class="si">{1:9.5f}</span><span class="s2"> </span><span class="si">{2:9.5f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
          <span class="nb">float</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">5</span><span class="p">])))</span>
</pre></div>
</div>
<p>This script takes <code class="docutils literal"><span class="pre">w_trace</span></code> output as a command line argument, loads the
iteration and segment IDs, loads the coordinates for each segment from
<cite>west.h5`</cite>, and saves the results into an xyz file viewable using <a class="reference external" href="http://www.ks.uiuc.edu/Research/vmd">VMD</a>.</p>
</div>
</div>
<div class="section" id="useful-links">
<h2>Useful links<a class="headerlink" href="#useful-links" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://ambermd.org">Official AMBER web page</a></li>
<li><a class="reference external" href="http://ambermd.org/tutorials">AMBER tutorials from the official web page</a></li>
<li><a class="reference external" href="http://www.ks.uiuc.edu/Research/vmd">Official VMD web page</a></li>
</ul>
</div>
<div class="section" id="useful-hints">
<h2>Useful hints<a class="headerlink" href="#useful-hints" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Make sure your paths are set correctly in <code class="docutils literal"><span class="pre">env.sh</span></code>.</li>
<li>If the simulation doesn&#8217;t stop properly with CTRL+C , use CTRL+Z.</li>
<li>Another method to stop the simulation relatively cleanly is to rename
<code class="docutils literal"><span class="pre">runseg.sh</span></code>; WESTPA will shut the simulation down and prevent the hdf5 file
from becoming corrupted. Some extra steps may be necessary to ensure that the
analysis scripts can be run successfully.</li>
</ul>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://pubs.acs.org/doi/abs/10.1021/ct100626x">Zwier, MC, Kaus, JW, Chong, LT. Efficient Explicit-Solvent Molecular
Dynamics Simulations of Molecular Association Kinetics: Methane/Methane,
Na+/Cl−, Methane/Benzene, and K+/18-Crown-6 Ether. J Chem Theory Comput.
2011.</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../sphinx_index.html">
              <img class="logo" src="../static/WESTPA2b.svg" alt="Logo"/>
            </a></p>
  <h3><a href="../sphinx_index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">AMBER Tutorial: Molecular Dynamics of Na<sup>+</sup>/Cl<sup>-</sup> Association</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#preparing-the-amber-files">Preparing the Amber files</a><ul>
<li><a class="reference internal" href="#md-continue-in">md-continue.in</a></li>
</ul>
</li>
<li><a class="reference internal" href="#preparing-the-westpa-files">Preparing the WESTPA files</a><ul>
<li><a class="reference internal" href="#env-sh">env.sh</a></li>
<li><a class="reference internal" href="#gen-istates-sh">gen_istates.sh</a></li>
<li><a class="reference internal" href="#get-pcoord-sh">get_pcoord.sh</a></li>
<li><a class="reference internal" href="#west-cfg">west.cfg</a></li>
<li><a class="reference internal" href="#aux-functions-py">aux_functions.py</a></li>
<li><a class="reference internal" href="#runseg-sh">runseg.sh</a></li>
<li><a class="reference internal" href="#post-iter-sh">post_iter.sh</a></li>
<li><a class="reference internal" href="#init-sh">init.sh</a></li>
<li><a class="reference internal" href="#run-sh">run.sh</a></li>
<li><a class="reference internal" href="#tar-segs-sh">tar_segs.sh</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-the-simulation">Running the simulation</a></li>
<li><a class="reference internal" href="#analyzing-the-data">Analyzing the data</a><ul>
<li><a class="reference internal" href="#output">Output</a><ul>
<li><a class="reference internal" href="#traj-segs">traj_segs</a></li>
<li><a class="reference internal" href="#seg-logs">seg_logs</a></li>
<li><a class="reference internal" href="#west-h5">west.h5</a></li>
<li><a class="reference internal" href="#west-log">west.log</a></li>
</ul>
</li>
<li><a class="reference internal" href="#computing-the-association-rate">Computing the association rate</a></li>
<li><a class="reference internal" href="#visualizing-a-selected-pathway">Visualizing a selected pathway</a></li>
</ul>
</li>
<li><a class="reference internal" href="#useful-links">Useful links</a></li>
<li><a class="reference internal" href="#useful-hints">Useful hints</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../sphinx_index.html">Documentation overview</a><ul>
      <li>Previous: <a href="chignolin.html" title="previous chapter">NAMD example: Molecular dynamics simulation of Chignolin</a></li>
      <li>Next: <a href="gromacs.html" title="next chapter">GROMACS Tutorial: Molecular Dynamics of Na<sup>+</sup>/Cl<sup>-</sup> Association</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../sources/tutorials/amber.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Matthew C. Zwier and Lillian T. Chong.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.9</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../sources/tutorials/amber.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>